

### 역전파 알고리즘 설명

________

![img](https://wikidocs.net/images/page/37406/nn1_final.PNG)

(단순한 형태의 인공신경망 예시) 
__ 입력층 (2개), 은닉층 (2개의 뉴런), 출력층(2개의 뉴런)

__ z : 가중합 / h : 활성화함수(시그모이드 함수) 지난 출력값



1. 순전파
    ![img](https://wikidocs.net/images/page/37406/nn2_final_final.PNG)

 ((STEP 1 : 입력 -> 은닉층))
$$
z_{1}=W_{1}x_{1} + W_{2}x_{2}=0.3 \text{×} 0.1 + 0.25 \text{×} 0.2= 0.08\\
z_{2}=W_{3}x_{1} + W_{4}x_{2}=0.4 \text{×} 0.1 + 0.35 \text{×} 0.2= 0.11
$$


$$
h_{1}=sigmoid(z_{1}) = 0.51998934\\
h_{2}=sigmoid(z_{2}) = 0.52747230
$$

 ((STEP 2 : 은닉 -> 출력층))
$$
z_{3}=W_{5}h_{1}+W_{6}h_{2} = 0.45 \text{×} h_{1} + 0.4 \text{×} h_{2} = 0.44498412\\
z_{4}=W_{7}h_{1}+W_{8}h_{2} = 0.7 \text{×} h_{1} + 0.6 \text{×} h_{2} = 0.68047592
$$
 ((STEP 3)) : 예측값과 실제값 오차 계산 _ 오차함수로 MSE 사용
$$
E_{o1}=\frac{1}{2}(target_{o1}-output_{o1})^{2}=0.02193381\\
E_{o2}=\frac{1}{2}(target_{o2}-output_{o2})^{2}=0.00203809\\
E_{total}=E_{o1}+E_{o2}=0.02397190
$$


2. 역전파 실시 - 역방향으로 가중치 업데이트

    - 다음의 가중치 업데이트를 해야함

    $$
    W_{5}, W_{6}, W_{7}, W_{8}
    $$

       - 각각 계산하면,

    

    
    $$
    \frac{∂E_{total}}{∂o_{1}}=2 \text{×} \frac{1}{2}(target_{o1}-output_{o1})^{2-1} \text{×} (-1) + 0
    $$

  세 값을 모두 곱해주면, 


$$
\frac{∂E_{total}}{∂o_{1}}=2 \text{×} \frac{1}{2}(target_{o1}-output_{o1})^{2-1} \text{×} (-1) + 0 $$
$$

$$
\frac{∂o_{1}}{∂z_{3}}=o_{1}\text{×}(1-o_{1})=0.60944600(1-0.60944600)=0.23802157\\ c.f. signoid function 미분하면?? :

f(x) \text{×} (1-f(x))
$$

$$
\frac{∂E_{total}}{∂W_{5}} = 0.20944600 \text{×} 0.23802157 \text{×} 0.51998934 = 0.02592286
$$








$$
\frac{∂E_{total}}{∂W_{5}} = 0.20944600 \text{×} 0.23802157 \text{×} 0.51998934 = 0.02592286
    $$
$$




경사하강법 통해 가중치 업데이트
$$
W_{5}^{+}=W_{5}-α\frac{∂E_{total}}{∂W_{5}}=0.45- 0.5 \text{×} 0.02592286=0.43703857\\
α :학습률(0.5라고 정해놓음!)
$$
W5는 0.45 에이와 같은 원리로 W1+ ~ W8+ 계산가능서 0.43이 되었음





3. 결과확인 : 순전파 다시 실시해서 Output 확인, 오차가 얼마나 감소했는지 비교
    인공신경망의 학습은 오차를 최소화하는 가중치를 찾는 목적으로 순전파와 역전파를 반복하는 것을 말함.

    ![img](https://wikidocs.net/images/page/37406/nn1_final.PNG)
